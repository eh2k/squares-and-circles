/*
 * Copyright 2013 Google Inc.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

#include <math.h>

#include "synth.h"
#include "exp2.h"

#if 1 //eh2k

#ifndef FLASHMEM
#include "pgmspace.h"
#endif

const int32_t exp2tab[2048] FLASHMEM = {
  727064,1073741824,727555,1074468888,728049,1075196443,728541,1075924492,729035,1076653033,729529,1077382068,730022,1078111597,730517,1078841619,731011,1079572136,731507,1080303147,732002,1081034654,
  732497,1081766656,732993,1082499153,733490,1083232146,733986,1083965636,734484,1084699622,734981,1085434106,735478,1086169087,735976,1086904565,736475,1087640541,736974,1088377016,737472,1089113990,
  737972,1089851462,738472,1090589434,738971,1091327906,739472,1092066877,739973,1092806349,740474,1093546322,740975,1094286796,741477,1095027771,741979,1095769248,742481,1096511227,742985,1097253708,
  743487,1097996693,743990,1098740180,744495,1099484170,744999,1100228665,745503,1100973664,746007,1101719167,746513,1102465174,747019,1103211687,747524,1103958706,748031,1104706230,748537,1105454261,
  749044,1106202798,749551,1106951842,750058,1107701393,750567,1108451451,751075,1109202018,751583,1109953093,752092,1110704676,752602,1111456768,753111,1112209370,753621,1112962481,754131,1113716102,
  754642,1114470233,755153,1115224875,755664,1115980028,756176,1116735692,756688,1117491868,757201,1118248556,757713,1119005757,758226,1119763470,758740,1120521696,759253,1121280436,759768,1122039689,
  760282,1122799457,760797,1123559739,761312,1124320536,761827,1125081848,762343,1125843675,762860,1126606018,763376,1127368878,763893,1128132254,764410,1128896147,764928,1129660557,765446,1130425485,
  765964,1131190931,766483,1131956895,767001,1132723378,767521,1133490379,768041,1134257900,768561,1135025941,769081,1135794502,769603,1136563583,770123,1137333186,770644,1138103309,771167,1138873953,
  771689,1139645120,772211,1140416809,772734,1141189020,773257,1141961754,773781,1142735011,774305,1143508792,774829,1144283097,775354,1145057926,775879,1145833280,776404,1146609159,776930,1147385563,
  777456,1148162493,777983,1148939949,778509,1149717932,779037,1150496441,779564,1151275478,780092,1152055042,780620,1152835134,781148,1153615754,781678,1154396902,782207,1155178580,782736,1155960787,
  783267,1156743523,783797,1157526790,784327,1158310587,784859,1159094914,785390,1159879773,785922,1160665163,786454,1161451085,786987,1162237539,787520,1163024526,788053,1163812046,788586,1164600099,
  789121,1165388685,789654,1166177806,790190,1166967460,790724,1167757650,791260,1168548374,791796,1169339634,792332,1170131430,792868,1170923762,793406,1171716630,793942,1172510036,794480,1173303978,
  795018,1174098458,795557,1174893476,796095,1175689033,796634,1176485128,797174,1177281762,797713,1178078936,798254,1178876649,798794,1179674903,799335,1180473697,799876,1181273032,800418,1182072908,
  800960,1182873326,801502,1183674286,802045,1184475788,802588,1185277833,803131,1186080421,803676,1186883552,804219,1187687228,804764,1188491447,805309,1189296211,805854,1190101520,806400,1190907374,
  806946,1191713774,807493,1192520720,808039,1193328213,808586,1194136252,809134,1194944838,809682,1195753972,810230,1196563654,810778,1197373884,811328,1198184662,811877,1198995990,812427,1199807867,
  812976,1200620294,813528,1201433270,814078,1202246798,814629,1203060876,815181,1203875505,815733,1204690686,816286,1205506419,816838,1206322705,817391,1207139543,817945,1207956934,818499,1208774879,
  819052,1209593378,819608,1210412430,820162,1211232038,820718,1212052200,821273,1212872918,821830,1213694191,822386,1214516021,822943,1215338407,823500,1216161350,824058,1216984850,824616,1217808908,
  825174,1218633524,825733,1219458698,826292,1220284431,826851,1221110723,827412,1221937574,827972,1222764986,828532,1223592958,829093,1224421490,829655,1225250583,830217,1226080238,830778,1226910455,
  831342,1227741233,831904,1228572575,832467,1229404479,833031,1230236946,833596,1231069977,834159,1231903573,834725,1232737732,835290,1233572457,835855,1234407747,836422,1235243602,836987,1236080024,
  837555,1236917011,838121,1237754566,838689,1238592687,839257,1239431376,839826,1240270633,840394,1241110459,840963,1241950853,841532,1242791816,842103,1243633348,842672,1244475451,843243,1245318123,
  843814,1246161366,844386,1247005180,844957,1247849566,845529,1248694523,846102,1249540052,846675,1250386154,847248,1251232829,847822,1252080077,848396,1252927899,848971,1253776295,849545,1254625266,
  850120,1255474811,850697,1256324931,851272,1257175628,851848,1258026900,852426,1258878748,853003,1259731174,853580,1260584177,854158,1261437757,854737,1262291915,855315,1263146652,855894,1264001967,
  856475,1264857861,857054,1265714336,857634,1266571390,858215,1267429024,858796,1268287239,859378,1269146035,859960,1270005413,860542,1270865373,861124,1271725915,861708,1272587039,862291,1273448747,
  862875,1274311038,863460,1275173913,864044,1276037373,864629,1276901417,865215,1277766046,865800,1278631261,866387,1279497061,866973,1280363448,867561,1281230421,868147,1282097982,868736,1282966129,
  869324,1283834865,869913,1284704189,870502,1285574102,871091,1286444604,871681,1287315695,872271,1288187376,872862,1289059647,873453,1289932509,874044,1290805962,874636,1291680006,875228,1292554642,
  875822,1293429870,876414,1294305692,877007,1295182106,877602,1296059113,878195,1296936715,878791,1297814910,879385,1298693701,879981,1299573086,880576,1300453067,881173,1301333643,881770,1302214816,
  882367,1303096586,882964,1303978953,883562,1304861917,884160,1305745479,884759,1306629639,885358,1307514398,885958,1308399756,886558,1309285714,887158,1310172272,887758,1311059430,888360,1311947188,
  888961,1312835548,889563,1313724509,890166,1314614072,890768,1315504238,891372,1316395006,891975,1317286378,892579,1318178353,893183,1319070932,893788,1319964115,894394,1320857903,894999,1321752297,
  895605,1322647296,896211,1323542901,896819,1324439112,897425,1325335931,898034,1326233356,898641,1327131390,899250,1328030031,899859,1328929281,900468,1329829140,901078,1330729608,901688,1331630686,
  902298,1332532374,902910,1333434672,903521,1334337582,904132,1335241103,904745,1336145235,905358,1337049980,905971,1337955338,906584,1338861309,907198,1339767893,907812,1340675091,908427,1341582903,
  909042,1342491330,909658,1343400372,910273,1344310030,910890,1345220303,911507,1346131193,912124,1347042700,912741,1347954824,913360,1348867565,913978,1349780925,914597,1350694903,915216,1351609500,
  915836,1352524716,916457,1353440552,917076,1354357009,917698,1355274085,918319,1356191783,918941,1357110102,919563,1358029043,920186,1358948606,920809,1359868792,921432,1360789601,922057,1361711033,
  922680,1362633090,923306,1363555770,923930,1364479076,924557,1365403006,925182,1366327563,925809,1367252745,926435,1368178554,927063,1369104989,927691,1370032052,928319,1370959743,928948,1371888062,
  929576,1372817010,930206,1373746586,930836,1374676792,931466,1375607628,932097,1376539094,932728,1377471191,933360,1378403919,933991,1379337279,934624,1380271270,935257,1381205894,935890,1382141151,
  936524,1383077041,937158,1384013565,937793,1384950723,938428,1385888516,939063,1386826944,939699,1387766007,940335,1388705706,940972,1389646041,941609,1390587013,942247,1391528622,942885,1392470869,
  943523,1393413754,944162,1394357277,944801,1395301439,945442,1396246240,946081,1397191682,946722,1398137763,947363,1399084485,948005,1400031848,948646,1400979853,949289,1401928499,949931,1402877788,
  950575,1403827719,951219,1404778294,951862,1405729513,952507,1406681375,953153,1407633882,953797,1408587035,954443,1409540832,955090,1410495275,955736,1411450365,956384,1412406101,957031,1413362485,
  957679,1414319516,958328,1415277195,958976,1416235523,959626,1417194499,960276,1418154125,960926,1419114401,961576,1420075327,962228,1421036903,962879,1421999131,963532,1422962010,964183,1423925542,
  964837,1424889725,965490,1425854562,966144,1426820052,966797,1427786196,967453,1428752993,968107,1429720446,968764,1430688553,969419,1431657317,970075,1432626736,970733,1433596811,971389,1434567544,
  972048,1435538933,972706,1436510981,973364,1437483687,974023,1438457051,974683,1439431074,975343,1440405757,976004,1441381100,976664,1442357104,977325,1443333768,977988,1444311093,978649,1445289081,
  979313,1446267730,979975,1447247043,980639,1448227018,981303,1449207657,981967,1450188960,982633,1451170927,983298,1452153560,983963,1453136858,984630,1454120821,985297,1455105451,985963,1456090748,
  986632,1457076711,987299,1458063343,987968,1459050642,988637,1460038610,989306,1461027247,989977,1462016553,990646,1463006530,991318,1463997176,991988,1464988494,992661,1465980482,993332,1466973143,
  994005,1467966475,994679,1468960480,995351,1469955159,996026,1470950510,996700,1471946536,997375,1472943236,998051,1473940611,998726,1474938662,999403,1475937388,1000079,1476936791,1000756,1477936870,
  1001434,1478937626,1002112,1479939060,1002791,1480941172,1003470,1481943963,1004149,1482947433,1004829,1483951582,1005510,1484956411,1006190,1485961921,1006872,1486968111,1007554,1487974983,1008235,1488982537,
  1008919,1489990772,1009602,1490999691,1010285,1492009293,1010969,1493019578,1011654,1494030547,1012339,1495042201,1013025,1496054540,1013710,1497067565,1014397,1498081275,1015083,1499095672,1015771,1500110755,
  1016459,1501126526,1017147,1502142985,1017836,1503160132,1018525,1504177968,1019215,1505196493,1019905,1506215708,1020596,1507235613,1021286,1508256209,1021978,1509277495,1022670,1510299473,1023363,1511322143,
  1024055,1512345506,1024749,1513369561,1025443,1514394310,1026138,1515419753,1026832,1516445891,1027527,1517472723,1028223,1518500250,1028919,1519528473,1029617,1520557392,1030313,1521587009,1031011,1522617322,
  1031709,1523648333,1032407,1524680042,1033107,1525712449,1033806,1526745556,1034507,1527779362,1035207,1528813869,1035907,1529849076,1036610,1530884983,1037311,1531921593,1038013,1532958904,1038717,1533996917,
  1039419,1535035634,1040124,1536075053,1040828,1537115177,1041532,1538156005,1042238,1539197537,1042944,1540239775,1043650,1541282719,1044356,1542326369,1045064,1543370725,1045771,1544415789,1046480,1545461560,
  1047188,1546508040,1047897,1547555228,1048607,1548603125,1049316,1549651732,1050028,1550701048,1050738,1551751076,1051450,1552801814,1052161,1553853264,1052875,1554905425,1053587,1555958300,1054300,1557011887,
  1055015,1558066187,1055729,1559121202,1056443,1560176931,1057159,1561233374,1057875,1562290533,1058591,1563348408,1059308,1564406999,1060026,1565466307,1060743,1566526333,1061461,1567587076,1062180,1568648537,
  1062899,1569710717,1063619,1570773616,1064340,1571837235,1065060,1572901575,1065781,1573966635,1066503,1575032416,1067224,1576098919,1067948,1577166143,1068671,1578234091,1069394,1579302762,1070119,1580372156,
  1070843,1581442275,1071568,1582513118,1072294,1583584686,1073020,1584656980,1073746,1585730000,1074474,1586803746,1075201,1587878220,1075929,1588953421,1076658,1590029350,1077386,1591106008,1078116,1592183394,
  1078847,1593261510,1079577,1594340357,1080307,1595419934,1081040,1596500241,1081771,1597581281,1082504,1598663052,1083237,1599745556,1083970,1600828793,1084704,1601912763,1085439,1602997467,1086174,1604082906,
  1086909,1605169080,1087645,1606255989,1088382,1607343634,1089119,1608432016,1089856,1609521135,1090594,1610610991,1091333,1611701585,1092071,1612792918,1092811,1613884989,1093551,1614977800,1094292,1616071351,
  1095032,1617165643,1095774,1618260675,1096516,1619356449,1097259,1620452965,1098001,1621550224,1098745,1622648225,1099489,1623746970,1100233,1624846459,1100979,1625946692,1101724,1627047671,1102470,1628149395,
  1103216,1629251865,1103963,1630355081,1104711,1631459044,1105459,1632563755,1106208,1633669214,1106957,1634775422,1107706,1635882379,1108456,1636990085,1109207,1638098541,1109958,1639207748,1110709,1640317706,
  1111462,1641428415,1112214,1642539877,1112967,1643652091,1113721,1644765058,1114475,1645878779,1115230,1646993254,1115985,1648108484,1116740,1649224469,1117497,1650341209,1118253,1651458706,1119011,1652576959,
  1119768,1653695970,1120527,1654815738,1121285,1655936265,1122044,1657057550,1122805,1658179594,1123564,1659302399,1124326,1660425963,1125086,1661550289,1125849,1662675375,1126611,1663801224,1127374,1664927835,
  1128137,1666055209,1128901,1667183346,1129665,1668312247,1130430,1669441912,1131196,1670572342,1131962,1671703538,1132728,1672835500,1133496,1673968228,1134262,1675101724,1135031,1676235986,1135800,1677371017,
  1136568,1678506817,1137338,1679643385,1138108,1680780723,1138879,1681918831,1139650,1683057710,1140422,1684197360,1141194,1685337782,1141967,1686478976,1142740,1687620943,1143513,1688763683,1144288,1689907196,
  1145063,1691051484,1145838,1692196547,1146615,1693342385,1147390,1694489000,1148167,1695636390,1148945,1696784557,1149723,1697933502,1150502,1699083225,1151280,1700233727,1152060,1701385007,1152840,1702537067,
  1153621,1703689907,1154402,1704843528,1155183,1705997930,1155966,1707153113,1156749,1708309079,1157531,1709465828,1158316,1710623359,1159100,1711781675,1159885,1712940775,1160670,1714100660,1161456,1715261330,
  1162243,1716422786,1163029,1717585029,1163817,1718748058,1164605,1719911875,1165394,1721076480,1166183,1722241874,1166972,1723408057,1167763,1724575029,1168553,1725742792,1169345,1726911345,1170137,1728080690,
  1170928,1729250827,1171722,1730421755,1172515,1731593477,1173309,1732765992,1174104,1733939301,1174898,1735113405,1175694,1736288303,1176491,1737463997,1177286,1738640488,1178084,1739817774,1178882,1740995858,
  1179680,1742174740,1180479,1743354420,1181278,1744534899,1182078,1745716177,1182878,1746898255,1183680,1748081133,1184481,1749264813,1185283,1750449294,1186085,1751634577,1186889,1752820662,1187692,1754007551,
  1188497,1755195243,1189301,1756383740,1190107,1757573041,1190912,1758763148,1191719,1759954060,1192526,1761145779,1193333,1762338305,1194142,1763531638,1194950,1764725780,1195759,1765920730,1196569,1767116489,
  1197379,1768313058,1198190,1769510437,1199001,1770708627,1199813,1771907628,1200625,1773107441,1201439,1774308066,1202252,1775509505,1203066,1776711757,1203881,1777914823,1204695,1779118704,1205512,1780323399,
  1206328,1781528911,1207145,1782735239,1207962,1783942384,1208780,1785150346,1209598,1786359126,1210418,1787568724,1211237,1788779142,1212058,1789990379,1212878,1791202437,1213699,1792415315,1214522,1793629014,
  1215343,1794843536,1216167,1796058879,1216990,1797275046,1217814,1798492036,1218639,1799709850,1219464,1800928489,1220290,1802147953,1221116,1803368243,1221942,1804589359,1222771,1805811301,1223598,1807034072,
  1224427,1808257670,1225256,1809482097,1226085,1810707353,1226916,1811933438,1227746,1813160354,1228578,1814388100,1229410,1815616678,1230242,1816846088,1231076,1818076330,1231908,1819307406,1232743,1820539314,
  1233578,1821772057,1234413,1823005635,1235249,1824240048,1236086,1825475297,1236922,1826711383,1237760,1827948305,1238598,1829186065,1239437,1830424663,1240276,1831664100,1241115,1832904376,1241957,1834145491,
  1242797,1835387448,1243638,1836630245,1244481,1837873883,1245324,1839118364,1246167,1840363688,1247010,1841609855,1247855,1842856865,1248700,1844104720,1249545,1845353420,1250392,1846602965,1251238,1847853357,
  1252086,1849104595,1252933,1850356681,1253782,1851609614,1254630,1852863396,1255481,1854118026,1256330,1855373507,1257181,1856629837,1258032,1857887018,1258884,1859145050,1259737,1860403934,1260590,1861663671,
  1261443,1862924261,1262297,1864185704,1263152,1865448001,1264008,1866711153,1264863,1867975161,1265720,1869240024,1266577,1870505744,1267434,1871772321,1268293,1873039755,1269151,1874308048,1270011,1875577199,
  1270871,1876847210,1271732,1878118081,1272592,1879389813,1273454,1880662405,1274317,1881935859,1275179,1883210176,1276043,1884485355,1276907,1885761398,1277772,1887038305,1278636,1888316077,1279503,1889594713,
  1280369,1890874216,1281236,1892154585,1282103,1893435821,1282972,1894717924,1283840,1896000896,1284710,1897284736,1285580,1898569446,1286450,1899855026,1287321,1901141476,1288193,1902428797,1289065,1903716990,
  1289938,1905006055,1290812,1906295993,1291685,1907586805,1292561,1908878490,1293435,1910171051,1294311,1911464486,1295188,1912758797,1296065,1914053985,1296942,1915350050,1297821,1916646992,1298699,1917944813,
  1299579,1919243512,1300458,1920543091,1301340,1921843549,1302220,1923144889,1303102,1924447109,1303985,1925750211,1304867,1927054196,1305751,1928359063,1306636,1929664814,1307520,1930971450,1308405,1932278970,
  1309291,1933587375,1310178,1934896666,1311065,1936206844,1311953,1937517909,1312842,1938829862,1313730,1940142704,1314619,1941456434,1315510,1942771053,1316401,1944086563,1317292,1945402964,1318184,1946720256,
  1319077,1948038440,1319970,1949357517,1320863,1950677487,1321758,1951998350,1322653,1953320108,1323549,1954642761,1324445,1955966310,1325341,1957290755,1326239,1958616096,1327137,1959942335,1328036,1961269472,
  1328935,1962597508,1329835,1963926443,1330735,1965256278,1331637,1966587013,1332538,1967918650,1333440,1969251188,1334344,1970584628,1335247,1971918972,1336151,1973254219,1337055,1974590370,1337961,1975927425,
  1338867,1977265386,1339774,1978604253,1340681,1979944027,1341589,1981284708,1342497,1982626297,1343406,1983968794,1344316,1985312200,1345226,1986656516,1346137,1988001742,1347048,1989347879,1347961,1990694927,
  1348873,1992042888,1349787,1993391761,1350701,1994741548,1351615,1996092249,1352531,1997443864,1353446,1998796395,1354363,2000149841,1355280,2001504204,1356198,2002859484,1357116,2004215682,1358034,2005572798,
  1358955,2006930832,1359875,2008289787,1360795,2009649662,1361717,2011010457,1362639,2012372174,1363562,2013734813,1364485,2015098375,1365408,2016462860,1366334,2017828268,1367258,2019194602,1368185,2020561860,
  1369111,2021930045,1370038,2023299156,1370965,2024669194,1371894,2026040159,1372823,2027412053,1373753,2028784876,1374683,2030158629,1375613,2031533312,1376545,2032908925,1377477,2034285470,1378410,2035662947,
  1379343,2037041357,1380278,2038420700,1381211,2039800978,1382148,2041182189,1383083,2042564337,1384019,2043947420,1384957,2045331439,1385894,2046716396,1386833,2048102290,1387772,2049489123,1388712,2050876895,
  1389652,2052265607,1390593,2053655259,1391535,2055045852,1392476,2056437387,1393420,2057829863,1394363,2059223283,1395308,2060617646,1396252,2062012954,1397198,2063409206,1398144,2064806404,1399090,2066204548,
  1400038,2067603638,1400986,2069003676,1401935,2070404662,1402883,2071806597,1403834,2073209480,1404785,2074613314,1405735,2076018099,1406688,2077423834,1407639,2078830522,1408594,2080238161,1409546,2081646755,
  1410502,2083056301,1411456,2084466803,1412412,2085878259,1413369,2087290671,1414326,2088704040,1415283,2090118366,1416242,2091533649,1417200,2092949891,1418160,2094367091,1419121,2095785251,1420081,2097204372,
  1421043,2098624453,1422006,2100045496,1422968,2101467502,1423932,2102890470,1424895,2104314402,1425861,2105739297,1426826,2107165158,1427793,2108591984,1428759,2110019777,1429726,2111448536,1430695,2112878262,
  1431664,2114308957,1432633,2115740621,1433603,2117173254,1434573,2118606857,1435545,2120041430,1436518,2121476975,1437489,2122913493,1438464,2124350982,1439437,2125789446,1440412,2127228883,1441387,2128669295,
  1442364,2130110682,1443340,2131553046,1444317,2132996386,1445295,2134440703,1446274,2135885998,1447253,2137332272,1448234,2138779525,1449214,2140227759,1450195,2141676973,1451177,2143127168,1452160,2144578345,
  1453143,2146030505,
  };

void Exp2::init() {}
  
const int32_t tanhtab[2048] FLASHMEM = {
  727064,1073741824,727555,1074468888,728049,1075196443,728541,1075924492,729035,1076653033,729529,1077382068,730022,1078111597,730517,1078841619,731011,1079572136,731507,1080303147,732002,1081034654,
  732497,1081766656,732993,1082499153,733490,1083232146,733986,1083965636,734484,1084699622,734981,1085434106,735478,1086169087,735976,1086904565,736475,1087640541,736974,1088377016,737472,1089113990,
  737972,1089851462,738472,1090589434,738971,1091327906,739472,1092066877,739973,1092806349,740474,1093546322,740975,1094286796,741477,1095027771,741979,1095769248,742481,1096511227,742985,1097253708,
  743487,1097996693,743990,1098740180,744495,1099484170,744999,1100228665,745503,1100973664,746007,1101719167,746513,1102465174,747019,1103211687,747524,1103958706,748031,1104706230,748537,1105454261,
  749044,1106202798,749551,1106951842,750058,1107701393,750567,1108451451,751075,1109202018,751583,1109953093,752092,1110704676,752602,1111456768,753111,1112209370,753621,1112962481,754131,1113716102,
  754642,1114470233,755153,1115224875,755664,1115980028,756176,1116735692,756688,1117491868,757201,1118248556,757713,1119005757,758226,1119763470,758740,1120521696,759253,1121280436,759768,1122039689,
  760282,1122799457,760797,1123559739,761312,1124320536,761827,1125081848,762343,1125843675,762860,1126606018,763376,1127368878,763893,1128132254,764410,1128896147,764928,1129660557,765446,1130425485,
  765964,1131190931,766483,1131956895,767001,1132723378,767521,1133490379,768041,1134257900,768561,1135025941,769081,1135794502,769603,1136563583,770123,1137333186,770644,1138103309,771167,1138873953,
  771689,1139645120,772211,1140416809,772734,1141189020,773257,1141961754,773781,1142735011,774305,1143508792,774829,1144283097,775354,1145057926,775879,1145833280,776404,1146609159,776930,1147385563,
  777456,1148162493,777983,1148939949,778509,1149717932,779037,1150496441,779564,1151275478,780092,1152055042,780620,1152835134,781148,1153615754,781678,1154396902,782207,1155178580,782736,1155960787,
  783267,1156743523,783797,1157526790,784327,1158310587,784859,1159094914,785390,1159879773,785922,1160665163,786454,1161451085,786987,1162237539,787520,1163024526,788053,1163812046,788586,1164600099,
  789121,1165388685,789654,1166177806,790190,1166967460,790724,1167757650,791260,1168548374,791796,1169339634,792332,1170131430,792868,1170923762,793406,1171716630,793942,1172510036,794480,1173303978,
  795018,1174098458,795557,1174893476,796095,1175689033,796634,1176485128,797174,1177281762,797713,1178078936,798254,1178876649,798794,1179674903,799335,1180473697,799876,1181273032,800418,1182072908,
  800960,1182873326,801502,1183674286,802045,1184475788,802588,1185277833,803131,1186080421,803676,1186883552,804219,1187687228,804764,1188491447,805309,1189296211,805854,1190101520,806400,1190907374,
  806946,1191713774,807493,1192520720,808039,1193328213,808586,1194136252,809134,1194944838,809682,1195753972,810230,1196563654,810778,1197373884,811328,1198184662,811877,1198995990,812427,1199807867,
  812976,1200620294,813528,1201433270,814078,1202246798,814629,1203060876,815181,1203875505,815733,1204690686,816286,1205506419,816838,1206322705,817391,1207139543,817945,1207956934,818499,1208774879,
  819052,1209593378,819608,1210412430,820162,1211232038,820718,1212052200,821273,1212872918,821830,1213694191,822386,1214516021,822943,1215338407,823500,1216161350,824058,1216984850,824616,1217808908,
  825174,1218633524,825733,1219458698,826292,1220284431,826851,1221110723,827412,1221937574,827972,1222764986,828532,1223592958,829093,1224421490,829655,1225250583,830217,1226080238,830778,1226910455,
  831342,1227741233,831904,1228572575,832467,1229404479,833031,1230236946,833596,1231069977,834159,1231903573,834725,1232737732,835290,1233572457,835855,1234407747,836422,1235243602,836987,1236080024,
  837555,1236917011,838121,1237754566,838689,1238592687,839257,1239431376,839826,1240270633,840394,1241110459,840963,1241950853,841532,1242791816,842103,1243633348,842672,1244475451,843243,1245318123,
  843814,1246161366,844386,1247005180,844957,1247849566,845529,1248694523,846102,1249540052,846675,1250386154,847248,1251232829,847822,1252080077,848396,1252927899,848971,1253776295,849545,1254625266,
  850120,1255474811,850697,1256324931,851272,1257175628,851848,1258026900,852426,1258878748,853003,1259731174,853580,1260584177,854158,1261437757,854737,1262291915,855315,1263146652,855894,1264001967,
  856475,1264857861,857054,1265714336,857634,1266571390,858215,1267429024,858796,1268287239,859378,1269146035,859960,1270005413,860542,1270865373,861124,1271725915,861708,1272587039,862291,1273448747,
  862875,1274311038,863460,1275173913,864044,1276037373,864629,1276901417,865215,1277766046,865800,1278631261,866387,1279497061,866973,1280363448,867561,1281230421,868147,1282097982,868736,1282966129,
  869324,1283834865,869913,1284704189,870502,1285574102,871091,1286444604,871681,1287315695,872271,1288187376,872862,1289059647,873453,1289932509,874044,1290805962,874636,1291680006,875228,1292554642,
  875822,1293429870,876414,1294305692,877007,1295182106,877602,1296059113,878195,1296936715,878791,1297814910,879385,1298693701,879981,1299573086,880576,1300453067,881173,1301333643,881770,1302214816,
  882367,1303096586,882964,1303978953,883562,1304861917,884160,1305745479,884759,1306629639,885358,1307514398,885958,1308399756,886558,1309285714,887158,1310172272,887758,1311059430,888360,1311947188,
  888961,1312835548,889563,1313724509,890166,1314614072,890768,1315504238,891372,1316395006,891975,1317286378,892579,1318178353,893183,1319070932,893788,1319964115,894394,1320857903,894999,1321752297,
  895605,1322647296,896211,1323542901,896819,1324439112,897425,1325335931,898034,1326233356,898641,1327131390,899250,1328030031,899859,1328929281,900468,1329829140,901078,1330729608,901688,1331630686,
  902298,1332532374,902910,1333434672,903521,1334337582,904132,1335241103,904745,1336145235,905358,1337049980,905971,1337955338,906584,1338861309,907198,1339767893,907812,1340675091,908427,1341582903,
  909042,1342491330,909658,1343400372,910273,1344310030,910890,1345220303,911507,1346131193,912124,1347042700,912741,1347954824,913360,1348867565,913978,1349780925,914597,1350694903,915216,1351609500,
  915836,1352524716,916457,1353440552,917076,1354357009,917698,1355274085,918319,1356191783,918941,1357110102,919563,1358029043,920186,1358948606,920809,1359868792,921432,1360789601,922057,1361711033,
  922680,1362633090,923306,1363555770,923930,1364479076,924557,1365403006,925182,1366327563,925809,1367252745,926435,1368178554,927063,1369104989,927691,1370032052,928319,1370959743,928948,1371888062,
  929576,1372817010,930206,1373746586,930836,1374676792,931466,1375607628,932097,1376539094,932728,1377471191,933360,1378403919,933991,1379337279,934624,1380271270,935257,1381205894,935890,1382141151,
  936524,1383077041,937158,1384013565,937793,1384950723,938428,1385888516,939063,1386826944,939699,1387766007,940335,1388705706,940972,1389646041,941609,1390587013,942247,1391528622,942885,1392470869,
  943523,1393413754,944162,1394357277,944801,1395301439,945442,1396246240,946081,1397191682,946722,1398137763,947363,1399084485,948005,1400031848,948646,1400979853,949289,1401928499,949931,1402877788,
  950575,1403827719,951219,1404778294,951862,1405729513,952507,1406681375,953153,1407633882,953797,1408587035,954443,1409540832,955090,1410495275,955736,1411450365,956384,1412406101,957031,1413362485,
  957679,1414319516,958328,1415277195,958976,1416235523,959626,1417194499,960276,1418154125,960926,1419114401,961576,1420075327,962228,1421036903,962879,1421999131,963532,1422962010,964183,1423925542,
  964837,1424889725,965490,1425854562,966144,1426820052,966797,1427786196,967453,1428752993,968107,1429720446,968764,1430688553,969419,1431657317,970075,1432626736,970733,1433596811,971389,1434567544,
  972048,1435538933,972706,1436510981,973364,1437483687,974023,1438457051,974683,1439431074,975343,1440405757,976004,1441381100,976664,1442357104,977325,1443333768,977988,1444311093,978649,1445289081,
  979313,1446267730,979975,1447247043,980639,1448227018,981303,1449207657,981967,1450188960,982633,1451170927,983298,1452153560,983963,1453136858,984630,1454120821,985297,1455105451,985963,1456090748,
  986632,1457076711,987299,1458063343,987968,1459050642,988637,1460038610,989306,1461027247,989977,1462016553,990646,1463006530,991318,1463997176,991988,1464988494,992661,1465980482,993332,1466973143,
  994005,1467966475,994679,1468960480,995351,1469955159,996026,1470950510,996700,1471946536,997375,1472943236,998051,1473940611,998726,1474938662,999403,1475937388,1000079,1476936791,1000756,1477936870,
  1001434,1478937626,1002112,1479939060,1002791,1480941172,1003470,1481943963,1004149,1482947433,1004829,1483951582,1005510,1484956411,1006190,1485961921,1006872,1486968111,1007554,1487974983,1008235,1488982537,
  1008919,1489990772,1009602,1490999691,1010285,1492009293,1010969,1493019578,1011654,1494030547,1012339,1495042201,1013025,1496054540,1013710,1497067565,1014397,1498081275,1015083,1499095672,1015771,1500110755,
  1016459,1501126526,1017147,1502142985,1017836,1503160132,1018525,1504177968,1019215,1505196493,1019905,1506215708,1020596,1507235613,1021286,1508256209,1021978,1509277495,1022670,1510299473,1023363,1511322143,
  1024055,1512345506,1024749,1513369561,1025443,1514394310,1026138,1515419753,1026832,1516445891,1027527,1517472723,1028223,1518500250,1028919,1519528473,1029617,1520557392,1030313,1521587009,1031011,1522617322,
  1031709,1523648333,1032407,1524680042,1033107,1525712449,1033806,1526745556,1034507,1527779362,1035207,1528813869,1035907,1529849076,1036610,1530884983,1037311,1531921593,1038013,1532958904,1038717,1533996917,
  1039419,1535035634,1040124,1536075053,1040828,1537115177,1041532,1538156005,1042238,1539197537,1042944,1540239775,1043650,1541282719,1044356,1542326369,1045064,1543370725,1045771,1544415789,1046480,1545461560,
  1047188,1546508040,1047897,1547555228,1048607,1548603125,1049316,1549651732,1050028,1550701048,1050738,1551751076,1051450,1552801814,1052161,1553853264,1052875,1554905425,1053587,1555958300,1054300,1557011887,
  1055015,1558066187,1055729,1559121202,1056443,1560176931,1057159,1561233374,1057875,1562290533,1058591,1563348408,1059308,1564406999,1060026,1565466307,1060743,1566526333,1061461,1567587076,1062180,1568648537,
  1062899,1569710717,1063619,1570773616,1064340,1571837235,1065060,1572901575,1065781,1573966635,1066503,1575032416,1067224,1576098919,1067948,1577166143,1068671,1578234091,1069394,1579302762,1070119,1580372156,
  1070843,1581442275,1071568,1582513118,1072294,1583584686,1073020,1584656980,1073746,1585730000,1074474,1586803746,1075201,1587878220,1075929,1588953421,1076658,1590029350,1077386,1591106008,1078116,1592183394,
  1078847,1593261510,1079577,1594340357,1080307,1595419934,1081040,1596500241,1081771,1597581281,1082504,1598663052,1083237,1599745556,1083970,1600828793,1084704,1601912763,1085439,1602997467,1086174,1604082906,
  1086909,1605169080,1087645,1606255989,1088382,1607343634,1089119,1608432016,1089856,1609521135,1090594,1610610991,1091333,1611701585,1092071,1612792918,1092811,1613884989,1093551,1614977800,1094292,1616071351,
  1095032,1617165643,1095774,1618260675,1096516,1619356449,1097259,1620452965,1098001,1621550224,1098745,1622648225,1099489,1623746970,1100233,1624846459,1100979,1625946692,1101724,1627047671,1102470,1628149395,
  1103216,1629251865,1103963,1630355081,1104711,1631459044,1105459,1632563755,1106208,1633669214,1106957,1634775422,1107706,1635882379,1108456,1636990085,1109207,1638098541,1109958,1639207748,1110709,1640317706,
  1111462,1641428415,1112214,1642539877,1112967,1643652091,1113721,1644765058,1114475,1645878779,1115230,1646993254,1115985,1648108484,1116740,1649224469,1117497,1650341209,1118253,1651458706,1119011,1652576959,
  1119768,1653695970,1120527,1654815738,1121285,1655936265,1122044,1657057550,1122805,1658179594,1123564,1659302399,1124326,1660425963,1125086,1661550289,1125849,1662675375,1126611,1663801224,1127374,1664927835,
  1128137,1666055209,1128901,1667183346,1129665,1668312247,1130430,1669441912,1131196,1670572342,1131962,1671703538,1132728,1672835500,1133496,1673968228,1134262,1675101724,1135031,1676235986,1135800,1677371017,
  1136568,1678506817,1137338,1679643385,1138108,1680780723,1138879,1681918831,1139650,1683057710,1140422,1684197360,1141194,1685337782,1141967,1686478976,1142740,1687620943,1143513,1688763683,1144288,1689907196,
  1145063,1691051484,1145838,1692196547,1146615,1693342385,1147390,1694489000,1148167,1695636390,1148945,1696784557,1149723,1697933502,1150502,1699083225,1151280,1700233727,1152060,1701385007,1152840,1702537067,
  1153621,1703689907,1154402,1704843528,1155183,1705997930,1155966,1707153113,1156749,1708309079,1157531,1709465828,1158316,1710623359,1159100,1711781675,1159885,1712940775,1160670,1714100660,1161456,1715261330,
  1162243,1716422786,1163029,1717585029,1163817,1718748058,1164605,1719911875,1165394,1721076480,1166183,1722241874,1166972,1723408057,1167763,1724575029,1168553,1725742792,1169345,1726911345,1170137,1728080690,
  1170928,1729250827,1171722,1730421755,1172515,1731593477,1173309,1732765992,1174104,1733939301,1174898,1735113405,1175694,1736288303,1176491,1737463997,1177286,1738640488,1178084,1739817774,1178882,1740995858,
  1179680,1742174740,1180479,1743354420,1181278,1744534899,1182078,1745716177,1182878,1746898255,1183680,1748081133,1184481,1749264813,1185283,1750449294,1186085,1751634577,1186889,1752820662,1187692,1754007551,
  1188497,1755195243,1189301,1756383740,1190107,1757573041,1190912,1758763148,1191719,1759954060,1192526,1761145779,1193333,1762338305,1194142,1763531638,1194950,1764725780,1195759,1765920730,1196569,1767116489,
  1197379,1768313058,1198190,1769510437,1199001,1770708627,1199813,1771907628,1200625,1773107441,1201439,1774308066,1202252,1775509505,1203066,1776711757,1203881,1777914823,1204695,1779118704,1205512,1780323399,
  1206328,1781528911,1207145,1782735239,1207962,1783942384,1208780,1785150346,1209598,1786359126,1210418,1787568724,1211237,1788779142,1212058,1789990379,1212878,1791202437,1213699,1792415315,1214522,1793629014,
  1215343,1794843536,1216167,1796058879,1216990,1797275046,1217814,1798492036,1218639,1799709850,1219464,1800928489,1220290,1802147953,1221116,1803368243,1221942,1804589359,1222771,1805811301,1223598,1807034072,
  1224427,1808257670,1225256,1809482097,1226085,1810707353,1226916,1811933438,1227746,1813160354,1228578,1814388100,1229410,1815616678,1230242,1816846088,1231076,1818076330,1231908,1819307406,1232743,1820539314,
  1233578,1821772057,1234413,1823005635,1235249,1824240048,1236086,1825475297,1236922,1826711383,1237760,1827948305,1238598,1829186065,1239437,1830424663,1240276,1831664100,1241115,1832904376,1241957,1834145491,
  1242797,1835387448,1243638,1836630245,1244481,1837873883,1245324,1839118364,1246167,1840363688,1247010,1841609855,1247855,1842856865,1248700,1844104720,1249545,1845353420,1250392,1846602965,1251238,1847853357,
  1252086,1849104595,1252933,1850356681,1253782,1851609614,1254630,1852863396,1255481,1854118026,1256330,1855373507,1257181,1856629837,1258032,1857887018,1258884,1859145050,1259737,1860403934,1260590,1861663671,
  1261443,1862924261,1262297,1864185704,1263152,1865448001,1264008,1866711153,1264863,1867975161,1265720,1869240024,1266577,1870505744,1267434,1871772321,1268293,1873039755,1269151,1874308048,1270011,1875577199,
  1270871,1876847210,1271732,1878118081,1272592,1879389813,1273454,1880662405,1274317,1881935859,1275179,1883210176,1276043,1884485355,1276907,1885761398,1277772,1887038305,1278636,1888316077,1279503,1889594713,
  1280369,1890874216,1281236,1892154585,1282103,1893435821,1282972,1894717924,1283840,1896000896,1284710,1897284736,1285580,1898569446,1286450,1899855026,1287321,1901141476,1288193,1902428797,1289065,1903716990,
  1289938,1905006055,1290812,1906295993,1291685,1907586805,1292561,1908878490,1293435,1910171051,1294311,1911464486,1295188,1912758797,1296065,1914053985,1296942,1915350050,1297821,1916646992,1298699,1917944813,
  1299579,1919243512,1300458,1920543091,1301340,1921843549,1302220,1923144889,1303102,1924447109,1303985,1925750211,1304867,1927054196,1305751,1928359063,1306636,1929664814,1307520,1930971450,1308405,1932278970,
  1309291,1933587375,1310178,1934896666,1311065,1936206844,1311953,1937517909,1312842,1938829862,1313730,1940142704,1314619,1941456434,1315510,1942771053,1316401,1944086563,1317292,1945402964,1318184,1946720256,
  1319077,1948038440,1319970,1949357517,1320863,1950677487,1321758,1951998350,1322653,1953320108,1323549,1954642761,1324445,1955966310,1325341,1957290755,1326239,1958616096,1327137,1959942335,1328036,1961269472,
  1328935,1962597508,1329835,1963926443,1330735,1965256278,1331637,1966587013,1332538,1967918650,1333440,1969251188,1334344,1970584628,1335247,1971918972,1336151,1973254219,1337055,1974590370,1337961,1975927425,
  1338867,1977265386,1339774,1978604253,1340681,1979944027,1341589,1981284708,1342497,1982626297,1343406,1983968794,1344316,1985312200,1345226,1986656516,1346137,1988001742,1347048,1989347879,1347961,1990694927,
  1348873,1992042888,1349787,1993391761,1350701,1994741548,1351615,1996092249,1352531,1997443864,1353446,1998796395,1354363,2000149841,1355280,2001504204,1356198,2002859484,1357116,2004215682,1358034,2005572798,
  1358955,2006930832,1359875,2008289787,1360795,2009649662,1361717,2011010457,1362639,2012372174,1363562,2013734813,1364485,2015098375,1365408,2016462860,1366334,2017828268,1367258,2019194602,1368185,2020561860,
  1369111,2021930045,1370038,2023299156,1370965,2024669194,1371894,2026040159,1372823,2027412053,1373753,2028784876,1374683,2030158629,1375613,2031533312,1376545,2032908925,1377477,2034285470,1378410,2035662947,
  1379343,2037041357,1380278,2038420700,1381211,2039800978,1382148,2041182189,1383083,2042564337,1384019,2043947420,1384957,2045331439,1385894,2046716396,1386833,2048102290,1387772,2049489123,1388712,2050876895,
  1389652,2052265607,1390593,2053655259,1391535,2055045852,1392476,2056437387,1393420,2057829863,1394363,2059223283,1395308,2060617646,1396252,2062012954,1397198,2063409206,1398144,2064806404,1399090,2066204548,
  1400038,2067603638,1400986,2069003676,1401935,2070404662,1402883,2071806597,1403834,2073209480,1404785,2074613314,1405735,2076018099,1406688,2077423834,1407639,2078830522,1408594,2080238161,1409546,2081646755,
  1410502,2083056301,1411456,2084466803,1412412,2085878259,1413369,2087290671,1414326,2088704040,1415283,2090118366,1416242,2091533649,1417200,2092949891,1418160,2094367091,1419121,2095785251,1420081,2097204372,
  1421043,2098624453,1422006,2100045496,1422968,2101467502,1423932,2102890470,1424895,2104314402,1425861,2105739297,1426826,2107165158,1427793,2108591984,1428759,2110019777,1429726,2111448536,1430695,2112878262,
  1431664,2114308957,1432633,2115740621,1433603,2117173254,1434573,2118606857,1435545,2120041430,1436518,2121476975,1437489,2122913493,1438464,2124350982,1439437,2125789446,1440412,2127228883,1441387,2128669295,
  1442364,2130110682,1443340,2131553046,1444317,2132996386,1445295,2134440703,1446274,2135885998,1447253,2137332272,1448234,2138779525,1449214,2140227759,1450195,2141676973,1451177,2143127168,1452160,2144578345,
  1453143,2146030505,
};

void Tanh::init() {}

#else

int32_t exp2tab[EXP2_N_SAMPLES << 1];

void Exp2::init() {
  double inc = exp2(1.0 / EXP2_N_SAMPLES);
  double y = 1 << 30;
  for (int i = 0; i < EXP2_N_SAMPLES; i++) {
    exp2tab[(i << 1) + 1] = (int32_t)floor(y + 0.5);
    y *= inc;
  }
  for (int i = 0; i < EXP2_N_SAMPLES - 1; i++) {
    exp2tab[i << 1] = exp2tab[(i << 1) + 3] - exp2tab[(i << 1) + 1];
  }
  exp2tab[(EXP2_N_SAMPLES << 1) - 2] = (1U << 31) - exp2tab[(EXP2_N_SAMPLES << 1) - 1];
}

int32_t tanhtab[TANH_N_SAMPLES << 1];

static double dtanh(double y) {
  return 1 - y * y;
}

void Tanh::init() {
  double step = 4.0 / TANH_N_SAMPLES;
  double y = 0;
  for (int i = 0; i < TANH_N_SAMPLES; i++) {
    tanhtab[(i << 1) + 1] = (1 << 24) * y + 0.5;
    //printf("%d\n", tanhtab[(i << 1) + 1]);
    // Use a basic 4th order Runge-Kutte to compute tanh from its
    // differential equation.
    double k1 = dtanh(y);
    double k2 = dtanh(y + 0.5 * step * k1);
    double k3 = dtanh(y + 0.5 * step * k2);
    double k4 = dtanh(y + step * k3);
    double dy = (step / 6) * (k1 + k4 + 2 * (k2 + k3));
    y += dy;
  }
  for (int i = 0; i < TANH_N_SAMPLES - 1; i++) {
    tanhtab[i << 1] = tanhtab[(i << 1) + 3] - tanhtab[(i << 1) + 1];
  }
  int32_t lasty = (1 << 24) * y + 0.5;
  tanhtab[(TANH_N_SAMPLES << 1) - 2] = lasty - tanhtab[(TANH_N_SAMPLES << 1) - 1];
}

#endif